#!/bin/sh

pgrep -x dmenu && exit

exclude="\(/boot\|/efi\|/\|/home\|/var\|/data\)$"
drives=$(lsblk -lp | grep "t /" | grep -v "$exclude" | awk '{print $1, "(" $4 ")", "on", $7}')
[ -z "$drives" ] && exit
chosen=$(echo "$drives" | dmenu -i -p "Drive to unmount?" | awk '{print $1}')
[ -z "$chosen" ] && exit
udisksctl unmount -b $chosen && dunstify -a "Driver mounter" "Unmounting status" "$chosen unmounted"
